<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<event category="CREATE" id="0">
  <actions>
    <action id="603" library="1">
      <!--action name: Code-->
      <kind>CODE</kind>
      <allowRelative>false</allowRelative>
      <question>false</question>
      <canApplyTo>true</canApplyTo>
      <actionType>CODE</actionType>
      <functionName/>
      <relative>false</relative>
      <not>false</not>
      <appliesTo>.self</appliesTo>
      <arguments>
        <argument kind="STRING">xoffset += sprite_xoffset;
yoffset += sprite_yoffset;
readyToShoot = false;
justShot = false;
// todo: switchBuffer? 
// update: what? I should be more specific writing these, I was in a zone 2 months ago
alarm[0] = refireTime / global.delta_factor;

ubering = false;
isMelee = false;

spark = 0;
alarm[9]= 2;

ability = -1;
abilityBuffer = -1;
abilityName = "";
abilityVisual = "";
abilityCharge = -1;
activateAbility = -1;
cancelAbility = -1;
depleteAbility = -1;
rechargeAbility = ACHARGE_RECHARGE;

meter = 0;
maxMeter = 100;
chargeWhileActive = false; // new, for weapons like BuffBanner and SodaPopper
pauseOnDestruction = false;
meterDrain = 1;
meterGain = 1;
rechargeRate = 1;

crit = 1;

// heavy specific, used in ShotT
chainGun = false;
// exact values
revSlowdown = 0.3;

// stops crashing as sniper for randomizerMode
t = 0;
baseDamage=-1;
unscopedDamage = 0;

// need this for projectile destruction
specialProjectile = -1;
destructProjectilesOnDeath = false;
isThrowable = false;
maxMines = 8;

// weaponGrade for Unique/Stock/Special
weaponGrade = WGRADE_STOCK;
// weaponType for each weapon
weaponType = WTYPE_SHOT;

owner = global.paramOwner;

// this took 3 hours of my life
// elaboration: it took me 3 hours trying to avoid this
// elaboration: this line is repeated in processClientCommands and Character Create step
// elaboration: I hate redundancy.
// despite all my rage this is the most reliable way to track activeWeapon as a cleaner variable than constantly asking the same if over and over
if object_index == global.weapons[owner.weapons[1]] {
    activeWeapon = 1;
} else {
    activeWeapon = 0;
}

jumpSlowdown = owner.baseJumpStrength;

pauseMeter[activeWeapon] = false;
// todo: decrease the alarm instead, or make a switchBuffer alarm instead of using refireTime, that's too strict
if (owner.runCombo) {
    readyToShoot = true;
    readyToStab = true;
    readyToFlare = true;
    readyToBlast = true;
    readyToSwing = true;
    owner.runCombo = false;
}

if (owner.ammo[activeWeapon] &lt; maxAmmo) {
    alarm[5] = (reloadBuffer + reloadTime) / global.delta_factor;
    alarm[6] = refireTime / global.delta_factor;
}

ownerPlayer = global.paramOwner.player;


// old variables are kept around for old plugins, can't replace em that easy
// todo: randomizerMode, move all weaponGrade/weaponType calls to child objects (hoo boyh)
switch(owner.player.class)
{
    case CLASS_MEDIC:
    uberCharge = owner.uberChargeC;
    uberReady = owner.uberReadyC;
    break;
    case CLASS_DEMOMAN:
        lobbed = owner.lobbed[activeWeapon];
    break;
}
// 'GW' reward - *G*olden *W*eapon
golden = hasClassReward(ownerPlayer, 'GW');
</argument>
      </arguments>
    </action>
  </actions>
</event>
